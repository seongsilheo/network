# 도커란?

복잡한 리눅스 어플리케이션을 **컨테이너로 묶어서 실행**할 수 있다. 그래서 좋은 점은 개발, 테스트, 서비스 환경을 하나로 통일하여 효율적으로 관리할 수 있는 것이다. 
컨테이너가 무엇이냐 하면, **가상화보다 훨씬 가벼운 기술**인데 그렇다면 가상화가 무엇인지 먼저 알아보도록 하자. 

<br/><br/>
## 가상머신과 도커
컴퓨터 성능이 급격히 좋아지면서 PC 사용량은 증가하였다. 서버 성능 또한 더욱 좋아졌다. 그러나 대부분의 시간을 서버가 놀고 있게 되버렸다. 이를 효율적으로 사용하기 위해  컴퓨터 안에서 컴퓨터를 만들어내기 위한 시도가 있었다. 이를 **가상머신**이라고 한다. 서버에 가상 머신을 여러개 띄워서 일을 더 시킬 수 있도록 하는 것이다. 가상 머신에 각종 서버 프로그램, DB 등을 설치해서 애플리케이션이나 웹사이트를 실행하였다. 미리 구축한 가상 머신 이미지를 여러 서버에  복사하여 실행하면 이미지 하나로  서버를 계속 만들어 낼  수 있다. 이러한 가상화 기술을 이용하여 **서버를 임대해주는 서비스가 클라우드  서비스**이다.

<br/><br/>
## 도커의 특징
 그런데  가상 머신은 좀 문제가 있다. 컴퓨터를 통째로 만들어내다 보니 각종 성능 손실이 발생한다. 그리하여 호스트와 커널을 공유하는 **반가상화 기술**이 등장하게 된다.  
 가상머신 vs 도커
 
 ![스크린샷 2019-09-07 오후 9 08 22](https://user-images.githubusercontent.com/44438752/64474735-b2c33700-d1b3-11e9-9785-4e94dd14d8c4.png)
 <br/><br/>
 가상 머신은 완전한 컴퓨터로 항상 게스트 OS를 설치해야 한다. 이미지 안에 OS가 포함되므로 용량이 커지고, 네트워크로 가상화 이미지를 주고 받는 것 또한 꽤나 부담스럽다.
 
 ![스크린샷 2019-09-07 오후 9 08 41](https://user-images.githubusercontent.com/44438752/64474736-b3f46400-d1b3-11e9-8c5b-ba97eed64395.png)
  <br/><br/>
 도커는 게스트 OS를 설치하지 않는다. 이미지에 서버 운영을 위한 프로그램과 라이브러리만 격리해서 설치한다. 그러므로 이미지 용량이 크게 줄어들고 호스트와 OS자원을 공유하게 된다. **컨테이너 안에 가상 공간을 만들지만 실행 파일을 호스트에서 직접 실행하게 된다.** 그러니 당연히 메모리 접근, 파일 시스템, 네트워크 전송 속도도 가상 머신에 비해 월등이 빠르게 되겠지? Github와 비슷한 형태로 도커 이미지를 공유하는 Docker Hub 제공. 다양한 API를 제공하여 원하는 만큼 자동화 가능. 개발과 서버 운영에 매우 유용.
 
 <br/><br/>
 ## 도커 이미지와 컨테이너
**이미지**는 서비스 운영에 필요한 서버 프로그램, 소스 코드, 컴파일된 실행 파일을 묶은 형태이고, **컨테이너**는 이미지를 실행한 상태이다. 운영 체제로 치면 이미지는 실행파일이고, 컨테이너는 프로세스다. (실행파일은 저장 매체에 존재하지만, 프로세스는 메모리에 존재. 어떤 실행파일이 여러 번 실행되었다면 메모리에는 여러 개의 같은 프로세스가 존재하게 됨. )

<br/><br/>
도커의 이미지 처리 방식
![스크린샷 2019-09-07 오후 9 29 44](https://user-images.githubusercontent.com/44438752/64474967-21ee5a80-d1b7-11e9-9d72-08de05d822cd.png)
도커는 베이스 이미지에서 바뀐 부분만 이미지로 생성하고, 컨테이너로 실행할 때는 베이스이미지와 바뀐 부분을 합쳐서 실행한다. Docker Hub 및 개인 저장소에서 이ㅁ지를 공유할 때 **바뀐 부분만** 주고 받는다. 각 이미지는 의존 관계를 형성하게 된다. 


<br/><br/>
## 서비으 운영 환경과 도커
지금까지는 **물리 서버**를 **직접 운영** 했다. 그러나 서버 구입과 설치에 돈이 많이 들고 시간이 오래 걸렸다. 가상화가 발전하면서 **클라우드 환경**으로 변화하였고, 가상 서버를 임대하여 사용한 만큼만 요금을 지불하는 방식을 취했다. 그러나 서버 대수가 많아지면서 사람이 일일이 세팅하기 힘들어졌다. 그리하여 **Immutable Infrastructure**  라는 패러다임이 나오게 되는데, 한번 설정한 운영 환경은 **변경하지 않는다(Immutable)** 라는 개념이다. 서비스 운영 환경을 **이미지로 생성**한 뒤에 **서버에 배포하여 실행한다.** 
![스크린샷 2019-09-07 오후 9 46 12](https://user-images.githubusercontent.com/44438752/64475094-ef456180-d1b8-11e9-8616-77b5a01f9f6f.png)
<br/><br/>
(출처: https://www.slideshare.net/pyrasis/docker-fordummies-44424016)
<br/><br/>
서비스가 **업데이트되면** 운영 환경 자체를 변경하지 않고, **이미지를 새로 생성하여 배포**한다. 

![스크린샷 2019-09-07 오후 9 55 49](https://user-images.githubusercontent.com/44438752/64475192-54e61d80-d1ba-11e9-9afe-85b09bcbb59a.png)

<br/><br/>
## 그래서 도커는?
고래는 서버에서 **여러 개의 컨테이너(이미지)를 실행**하고 **이미지 저장과 배포(운반)** 을 의미. 도커는 서비스 운영 환경을 묶어서 손쉽게 배포하고 실행하는 경량 컨테이너 기술.
